@for (val of data().content; track $index) {
    <p>{{ val.id }}</p>
}
<div class="bg-white rounded-xl border border-gray-200 overflow-hidden">
    <p-table
        [value]="data().content"
        [paginator]="true"
        [columns]="columns"
        [rows]="10"
        [totalRecords]="10"
        [rowsPerPageOptions]="[10, 25, 50]"
        [paginatorDropdownAppendTo]="'body'"
        [lazy]="true"
        responsiveLayout="scroll"
        dataKey="id"
    >
        <ng-template #header let-columns>
            <tr>
                <!-- <th pFrozenColumn style="width: 3rem">
                    <p-tableHeaderCheckbox />
                </th> -->
                <th>№</th>
                @for (col of columns; track $index) {
                    <th
                        [pSortableColumn]="col.sortable ? col.field : undefined"
                    >
                        <span class="flex items-center gap-2"
                            >{{ col.header || col.field }}
                            @if (col.sortable) {
                                <p-sortIcon [field]="col.field" />
                            }
                        </span>
                    </th>
                }
            </tr>
        </ng-template>

        <!-- <ng-template pTemplate="body" let-course let-rowIndex="rowIndex">
            <tr
                class="hover:bg-gray-50 transition-colors duration-150"
                [class.bg-gray-25]="rowIndex % 2 === 0"
            >
                <td
                    class="py-3! px-4 text-sm text-gray-600 border-b border-gray-100"
                >
                    {{ course.id }}
                </td>
                <td
                    class="py-3! px-4 text-sm text-gray-600 border-b border-gray-100"
                >
                    @if (course.title && course.title.uz) {
                        {{ course.title.uz }}
                    } @else {
                        {{ course.title }}
                    }
                </td>
                <td
                    class="py-3! px-4 text-sm text-gray-600 border-b border-gray-100"
                >
                    @if (course.description && course.description.uz) {
                        {{ course.description.uz }}
                    } @else {
                        {{ course.description }}
                    }
                </td>
            </tr>
        </ng-template> -->

        <ng-template
            #body
            let-rowData
            let-columns="columns"
            let-rowIndex="rowIndex"
        >
            @if (!rowData.loading) {
                <tr>
                    <!-- <td pFrozenColumn>
                        <p-tableCheckbox [value]="rowData" />
                    </td> -->
                    <td>
                        {{ rowData.id }}
                    </td>
                    @for (col of columns; track $index) {
                        <td>
                            @switch (col.type) {
                                @case ('img') {
                                    <img
                                        [src]="
                                            'http://167.86.71.210:4002/api/' +
                                            (col.apiName
                                                | getDeepValue: rowData)
                                        "
                                        [alt]="col.title"
                                        class="w-10 h-10 rounded-lg object-cover"
                                    />
                                }
                                @case ('translate') {
                                    {{
                                        col.apiName
                                            | getDeepValue: rowData
                                            | bamTranslateNameAsync
                                            | async
                                    }}
                                }
                                @case ('date') {
                                    {{
                                        col.apiName
                                            | getDeepValue: rowData
                                            | date: 'dd.MM.yyyy'
                                    }}
                                }
                                @case ('actions') {
                                    <div
                                        class="flex justify-start items-center gap-2"
                                    >
                                        <a
                                            [routerLink]="
                                                'edit/' +
                                                (col.apiName
                                                    | getDeepValue: rowData)
                                            "
                                            class="px-3 py-2 bg-blue-500 rounded-lg cursor-pointer hover:bg-blue-600 transition-colors"
                                            title="Редактировать"
                                        >
                                            <span
                                                class="pi pi-pencil text-white"
                                            ></span>
                                        </a>
                                        <!-- <button
                                            class="px-3 py-2 bg-red-500 rounded-lg cursor-pointer hover:bg-red-600 transition-colors"
                                            (click)="deleteData(course)"
                                            [disabled]="loading"
                                            title="Удалить"
                                        >
                                            <span
                                                class="pi pi-trash text-white"
                                            ></span>
                                        </button> -->
                                    </div>
                                }
                                @default {
                                    {{ col.apiName | getDeepValue: rowData }}
                                }
                            }
                        </td>
                    }
                </tr>
            } @else {
                <tr>
                    @for (col of columns; track col.field) {
                        <td>
                            <!-- <p-skeleton height="20px" /> -->
                        </td>
                    }
                    <td>
                        <!-- <p-skeleton height="20px" /> -->
                    </td>
                </tr>
            }
        </ng-template>

        <!-- <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="9" class="text-center py-12">
                    <div
                        class="flex flex-col items-center justify-center text-gray-500"
                    >
                        <i class="pi pi-search text-4xl mb-3 text-gray-400"></i>
                        <h3 class="text-lg font-medium text-gray-700 mb-1">
                            {{ searchTerm ? 'Курсы не найдены' : 'Нет курсов' }}
                        </h3>
                        <p class="text-sm text-gray-500">
                            {{
                                searchTerm
                                    ? 'Попробуйте изменить критерии поиска'
                                    : 'Создайте первый курс'
                            }}
                        </p>
                        <button
                            *ngIf="searchTerm"
                            (click)="clearFilters()"
                            class="mt-3 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
                        >
                            Сбросить фильтры
                        </button>
                    </div>
                </td>
            </tr>
        </ng-template> -->

        <ng-template pTemplate="loadingbody">
            <tr>
                <td colspan="9" class="text-center py-12">
                    <div class="flex flex-col items-center justify-center">
                        <div
                            class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mb-3"
                        ></div>
                        <p class="text-sm text-gray-500">Загрузка курсов...</p>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</div>
